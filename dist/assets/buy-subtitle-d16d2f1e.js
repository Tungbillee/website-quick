import{l as v}from"./loading_curso-23b286ab.js";import{_ as f,r as p,o as c,c as d,F as u,a as s,i as x,v as y,e as w,t as n,l as T,f as S,h as k,p as M,j as P}from"./index-ac4777e4.js";import{b as h}from"./route-block-83d24a4e.js";const g={components:{loading:v},data(){return{user:{},is_buy:!0,is_loading:!1,error_message:"",minutes_buy:"",buyingOptions:[{minutes:"> 500 phút",discountText:"Không có giảm giá",discountClass:"",priceText:"700đ/phút"},{minutes:"> 5000 phút",discountText:"Giảm 20%",discountClass:"text-red",priceText:"500đ/phút"},{minutes:"> 20.000 phút",discountText:"Giảm 30%",discountClass:"text-green",priceText:"400đ/phút"},{minutes:"> 100.000 phút",discountText:"Giảm 50%",discountClass:"text-yellows",priceText:"350đ/phút"}]}},created(){this.getUser()},computed:{totalPrice(){const t=Number(this.minutes_buy);return t?t>1e5?t*350:t>2e4?t*400:t>5e3?t*500:t*700:0}},methods:{img(t){return"images/admin-panel/"+t},goToManage(){this.$router.push("/settings")},async payMentSubtitle(){this.is_loading=!0;let t=await this.api({path:"/web/user/buy-subtitle",method:"POST",data:{number_minutes_subtitle:this.minutes_buy}});t.success?this.is_buy=!1:this.error_message=t.message,this.is_loading=!1},async getUser(t=3){try{let i=await this.api({path:"/web/user/get-info"});if(i.success)this.user=i.data_user;else throw new Error("API request failed")}catch(i){if(console.error("Error fetching user info:",i),t>0)return console.log(`Retrying... ${t} attempts left`),await new Promise(r=>setTimeout(r,1e3)),this.getUser(t-1);console.error("Max retry attempts reached")}},formatPrice(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},handleBuyMore(){this.is_loading=!0}}},a=t=>(M("data-v-dbdbb8a8"),t=t(),P(),t),C={class:"container-buy-more"},j=a(()=>s("div",{class:"spaces"},null,-1)),B={class:"table-buy-more"},I={class:"section-buy-more"},H=["src"],N=a(()=>s("div",{class:"fw-600"},"Quay lại",-1)),U=a(()=>s("div",{class:"text-green mgt-50 fw-600"},"MUA THÊM THỜI LƯỢNG TÁCH PHỤ ĐỀ",-1)),E={class:"select-number-minutes"},G=a(()=>s("div",null,"Số phút bạn muốn mua thêm là:",-1)),L={class:"flex-bw-al mgt-10"},O=a(()=>s("div",null,"Phút",-1)),q={class:"options-buy-more"},z={class:"notie-buy flex-al gap-10"},A=["src"],D=a(()=>s("div",{class:"fw-600"},"HOT DEAL - Mua càng nhiều, giảm càng sâu",-1)),V={class:"flex-al gap-10"},F={class:"billing-buy-more"},K={class:"body-billing-buy-more flex-cl gap-40"},Q=S('<div class="flex-bw-al" data-v-dbdbb8a8><div class="text-300" data-v-dbdbb8a8>Loại mua</div><div class="fw-600" data-v-dbdbb8a8>Mua phút phụ đề</div></div><div class="flex-bw-al" data-v-dbdbb8a8><div class="text-300" data-v-dbdbb8a8>Thời hạn mua</div><div class="fw-600" data-v-dbdbb8a8>Sẽ hết hạn khi gói cước hết hạn</div></div>',2),R={class:"flex-bw-al"},J=a(()=>s("div",{class:"text-300"},"Chi tiết",-1)),W={class:"fw-600"},X={class:"flex-bw-al"},Y=a(()=>s("div",{class:"text-300"},"Tổng giá",-1)),Z={class:"fw-600"},$={class:"footer-billing-buy-more"},ss={class:"flex-bw-al"},ts=a(()=>s("div",{class:"text-300"},"Số point cần thanh toán",-1)),es={class:"fw-600"},is={class:"info-balace flex-bw-al"},as={class:"flex-al gap-5"},os=["src"],ls=a(()=>s("div",{class:"fw-600"},"Số dư tài khoản",-1)),ns={class:"flex-al gap-5"},cs={class:"fw-600"},ds={class:"flex-al gap-3"},rs=["src"],_s=a(()=>s("div",{class:"text-yellow fw-600"},"Point",-1)),us={key:1},hs={class:"flex-al-jt text-red mgt-15"},gs={key:1,class:"flex-al-jt",style:{width:"100%",height:"100%"}},bs={class:"flex-cl-jt"},ms=["src"],vs=a(()=>s("div",{style:{"text-align":"center"},class:"fw-600 fz-24 mgt-10"},"Thanh toán thành công",-1)),fs=a(()=>s("div",{class:"fz-16 mgt-10"},"Đến trang quản lý xem chi tiết giao dịch",-1));function ps(t,i,r,xs,l,e){var _;const b=p("loading");return c(),d("div",C,[l.is_buy?(c(),d(u,{key:0},[j,s("div",B,[s("div",I,[s("div",{class:"flex-al gap-3",onClick:i[0]||(i[0]=(...o)=>e.goToManage&&e.goToManage(...o))},[s("img",{src:e.img("icon_back.svg"),alt:""},null,8,H),N]),U,s("div",E,[G,s("div",L,[x(s("input",{type:"number",class:"text-300","onUpdate:modelValue":i[1]||(i[1]=o=>l.minutes_buy=o),placeholder:"Nhập số phút..."},null,512),[[y,l.minutes_buy]]),O])]),s("div",q,[s("div",z,[s("img",{src:e.img("icon_deal.svg"),alt:""},null,8,A),D]),(c(!0),d(u,null,w(l.buyingOptions,(o,m)=>(c(),d("div",{class:"items-buy",key:m},[s("div",null,n(o.minutes),1),s("div",V,[s("div",{class:k(["discount",o.discountClass])},n(o.discountText),3),s("div",null,n(o.priceText),1)])]))),128))])]),s("div",F,[s("div",K,[Q,s("div",R,[J,s("div",W,n(l.minutes_buy||0)+" phút",1)]),s("div",X,[Y,s("div",Z,n(e.formatPrice(e.totalPrice))+" Point",1)])]),s("div",$,[s("div",ss,[ts,s("div",es,n(e.formatPrice(e.totalPrice))+" Point",1)]),s("div",is,[s("div",as,[s("img",{src:e.img("icon_card_buy_more.svg"),alt:""},null,8,os),ls]),s("div",ns,[s("div",cs,n(e.formatPrice(((_=l.user)==null?void 0:_.balance)??0)),1),s("div",ds,[s("img",{src:e.img("icon_point.svg"),alt:""},null,8,rs),_s])])]),s("div",{class:"button mgt-20 flex-al-jt",style:{"border-radius":"10px",height:"45px"},onClick:i[2]||(i[2]=(...o)=>e.payMentSubtitle&&e.payMentSubtitle(...o))},[l.is_loading?(c(),T(b,{key:0})):(c(),d("div",us,"Thanh toán ngay"))]),s("div",hs,n(l.error_message),1)])])])],64)):(c(),d("div",gs,[s("div",bs,[s("img",{style:{"padding-left":"20px"},src:e.img("buy_success.svg"),alt:""},null,8,ms),vs,fs,s("div",{class:"button mgt-30 flex-al-jt",onClick:i[3]||(i[3]=(...o)=>e.goToManage&&e.goToManage(...o))},"Đến trang quản lý")])]))])}typeof h=="function"&&h(g);const Ss=f(g,[["render",ps],["__scopeId","data-v-dbdbb8a8"]]);export{Ss as default};
