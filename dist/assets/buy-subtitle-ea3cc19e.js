import{l as b}from"./loading_curso-f726969d.js";import{_ as p,r as x,o as l,c as d,F as _,a as s,i as y,v as w,e as T,h,t as o,m as k,f as P,p as M,j as S}from"./index-a44896c8.js";import{b as g}from"./route-block-83d24a4e.js";const m={components:{loading:b},data(){return{user:{},is_buy:!0,is_loading:!1,error_message:"",minutes_buy:"",buyingOptions:[{minutes:"> 500 phút",discountText:"Không có giảm giá",discountClass:"",priceText:"700đ/phút"},{minutes:"> 5000 phút",discountText:"Giảm 20%",discountClass:"text-red",priceText:"500đ/phút"},{minutes:"> 20.000 phút",discountText:"Giảm 30%",discountClass:"text-green",priceText:"400đ/phút"},{minutes:"> 100.000 phút",discountText:"Giảm 50%",discountClass:"text-yellows",priceText:"350đ/phút"}]}},created(){this.getUser()},computed:{totalPrice(){const t=Number(this.minutes_buy);return t?t>1e5?t*350:t>2e4?t*400:t>5e3?t*500:t*700:0},activePackageMinutes(){const t=Number(this.minutes_buy);return t?t>1e5?1e5:t>2e4?2e4:t>5e3?5e3:t>500?500:0:0}},methods:{img(t){return"images/admin-panel/"+t},isActivePackage(t){const i={"> 100.000 phút":1e5,"> 20.000 phút":2e4,"> 5000 phút":5e3,"> 500 phút":500};return this.activePackageMinutes===i[t.minutes]},goToManage(){this.$router.push("/settings")},async payMentSubtitle(){this.is_loading=!0;let t=await this.api({path:"/web/user/buy-subtitle",method:"POST",data:{number_minutes_subtitle:this.minutes_buy}});t.success?this.is_buy=!1:this.error_message=t.message,this.is_loading=!1},async getUser(t=3){try{let i=await this.api({path:"/web/user/get-info"});if(i.success)this.user=i.data_user;else throw new Error("API request failed")}catch(i){if(console.error("Error fetching user info:",i),t>0)return console.log(`Retrying... ${t} attempts left`),await new Promise(r=>setTimeout(r,1e3)),this.getUser(t-1);console.error("Max retry attempts reached")}},formatPrice(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},handleBuyMore(){this.is_loading=!0}}},n=t=>(M("data-v-2cd5588b"),t=t(),S(),t),C={class:"container-buy-more"},j=n(()=>s("div",{class:"spaces"},null,-1)),B={class:"table-buy-more"},I={class:"section-buy-more"},N=["src"],A=n(()=>s("div",{class:"fw-600"},"Quay lại",-1)),H=n(()=>s("div",{class:"text-green mgt-50 fw-600"},"MUA THÊM THỜI LƯỢNG TÁCH PHỤ ĐỀ",-1)),U={class:"select-number-minutes"},E=n(()=>s("div",null,"Số phút bạn muốn mua thêm là:",-1)),G={class:"flex-bw-al mgt-10"},L=n(()=>s("div",null,"Phút",-1)),O={class:"options-buy-more"},q={class:"notie-buy flex-al gap-10"},z=["src"],D=n(()=>s("div",{class:"fw-600"},"HOT DEAL - Mua càng nhiều, giảm càng sâu",-1)),V={class:"flex-al gap-10"},F={class:"billing-buy-more"},K={class:"body-billing-buy-more flex-cl gap-40"},Q=P('<div class="flex-bw-al" data-v-2cd5588b><div class="text-300" data-v-2cd5588b>Loại mua</div><div class="fw-600" data-v-2cd5588b>Mua phút phụ đề</div></div><div class="flex-bw-al" data-v-2cd5588b><div class="text-300" data-v-2cd5588b>Thời hạn mua</div><div class="fw-600" data-v-2cd5588b>Sẽ hết hạn khi gói cước hết hạn</div></div>',2),R={class:"flex-bw-al"},J=n(()=>s("div",{class:"text-300"},"Chi tiết",-1)),W={class:"fw-600"},X={class:"flex-bw-al"},Y=n(()=>s("div",{class:"text-300"},"Tổng giá",-1)),Z={class:"fw-600"},$={class:"footer-billing-buy-more"},ss={class:"flex-bw-al"},ts=n(()=>s("div",{class:"text-300"},"Số point cần thanh toán",-1)),es={class:"fw-600"},is={class:"info-balace flex-bw-al"},as={class:"flex-al gap-5"},ns=["src"],cs=n(()=>s("div",{class:"fw-600"},"Số dư tài khoản",-1)),os={class:"flex-al gap-5"},ls={class:"fw-600"},ds={class:"flex-al gap-3"},rs=["src"],us=n(()=>s("div",{class:"text-yellow fw-600"},"Point",-1)),_s={key:1},hs={class:"flex-al-jt text-red mgt-15"},gs={key:1,class:"flex-al-jt",style:{width:"100%",height:"100%"}},ms={class:"flex-cl-jt"},vs=["src"],fs=n(()=>s("div",{style:{"text-align":"center"},class:"fw-600 fz-24 mgt-10"},"Thanh toán thành công",-1)),bs=n(()=>s("div",{class:"fz-16 mgt-10"},"Đến trang quản lý xem chi tiết giao dịch",-1));function ps(t,i,r,xs,c,e){var u;const v=x("loading");return l(),d("div",C,[c.is_buy?(l(),d(_,{key:0},[j,s("div",B,[s("div",I,[s("div",{class:"flex-al gap-3",onClick:i[0]||(i[0]=(...a)=>e.goToManage&&e.goToManage(...a))},[s("img",{src:e.img("icon_back.svg"),alt:""},null,8,N),A]),H,s("div",U,[E,s("div",G,[y(s("input",{type:"number",class:"text-300","onUpdate:modelValue":i[1]||(i[1]=a=>c.minutes_buy=a),placeholder:"Nhập số phút..."},null,512),[[w,c.minutes_buy]]),L])]),s("div",O,[s("div",q,[s("img",{src:e.img("icon_deal.svg"),alt:""},null,8,z),D]),(l(!0),d(_,null,T(c.buyingOptions,(a,f)=>(l(),d("div",{class:h(["items-buy",{active:e.isActivePackage(a)}]),key:f},[s("div",null,o(a.minutes),1),s("div",V,[s("div",{class:h(["discount",a.discountClass])},o(a.discountText),3),s("div",null,o(a.priceText),1)])],2))),128))])]),s("div",F,[s("div",K,[Q,s("div",R,[J,s("div",W,o(c.minutes_buy||0)+" phút",1)]),s("div",X,[Y,s("div",Z,o(e.formatPrice(e.totalPrice))+" Point",1)])]),s("div",$,[s("div",ss,[ts,s("div",es,o(e.formatPrice(e.totalPrice))+" Point",1)]),s("div",is,[s("div",as,[s("img",{src:e.img("icon_card_buy_more.svg"),alt:""},null,8,ns),cs]),s("div",os,[s("div",ls,o(e.formatPrice(((u=c.user)==null?void 0:u.balance)??0)),1),s("div",ds,[s("img",{src:e.img("icon_point.svg"),alt:""},null,8,rs),us])])]),s("div",{class:"button mgt-20 flex-al-jt",style:{"border-radius":"10px",height:"45px"},onClick:i[2]||(i[2]=(...a)=>e.payMentSubtitle&&e.payMentSubtitle(...a))},[c.is_loading?(l(),k(v,{key:0})):(l(),d("div",_s,"Thanh toán ngay"))]),s("div",hs,o(c.error_message),1)])])])],64)):(l(),d("div",gs,[s("div",ms,[s("img",{style:{"padding-left":"20px"},src:e.img("buy_success.svg"),alt:""},null,8,vs),fs,bs,s("div",{class:"button mgt-30 flex-al-jt",onClick:i[3]||(i[3]=(...a)=>e.goToManage&&e.goToManage(...a))},"Đến trang quản lý")])]))])}typeof g=="function"&&g(m);const ks=p(m,[["render",ps],["__scopeId","data-v-2cd5588b"]]);export{ks as default};
